AFFECT [[7182484153792115919]]

IMPORT net.asivery.CommandExecutor 1.0
IMPORT QtQuick.Layouts 1.3
IMPORT QtQuick.Controls 2.15

TRAVERSE [[6502786168]]#[[6504254477]]
LOCATE BEFORE ALL
INSERT {
    ~&6502786168&~ {
        ~&7083038346995&~: ~&1703967276691339681&~
        ~&5972374&~: myValues
        property ~&197088788&~ last_input_length: 0
        property ~&197102514&~ candidates
    }
}
INSERT {
    CommandExecutor {
        ~&5972374&~: cmdExecutor
    }
}
END TRAVERSE
TRAVERSE [[6502786168]]#[[6504254477]] > [[6502786168]]#[[12597697629085243357]] > [[6502786168]]#[[7066546362478499224]]
LOCATE AFTER [[16662649647875525590]][.[[5972374]]=[[8400021782649939695]]]
INSERT {
    ~&254501108490678590&~ {
        ~&7083038346995&~: ~&1703967276691339681&~
        ~&180995&~: 100
        ~&214622605608&~: ~&"214621299494&~
        ~&233721384511543&~ {
            ~&6504027668&~: ~&8400021782649939695&~.~&214640173127&~
            ~&8399743405844438450&~: 30
            ~&197100796&~: ~&7083038346995&~.~&197100796&~
        }
        ~&214646099849&~: 1100
        ~&7082729686082&~: 100
        ScrollView {
            ~&233721384511543&~.~&6503816592&~: ~&7083038346995&~
            ~&214646099849&~: 1100
            ~&7082729686082&~: 100
            ~&6503711953&~: ~&6504329801&~ 
            ~&197063777&~ {
                ~&233721384511543&~.~&6503816592&~: ~&7083038346995&~
                ~&214646099849&~: 1100
                ~&7082729686082&~: 100
                ~&7712155293725601&~ {
                    ~&214634455770&~: myValues.candidates.~&7082886407723&~

                    ~&7712922269353028&~: ~&254501108490678590&~ {
                        ~&214622605608&~: ~&"214621299494&~
                        ~&5972374&~: candidateSelect
                        ~&214646099849&~: ~&502649234619747013&~.~&214646099849&~ + 20
                        ~&7082729686082&~: 100

                        function insertstuff() {
                            ~&197085552&~(~&197091758&~ ~&180978&~ = 0;~&180978&~<myValues.last_input_length;~&180978&~++) {
                                ~&1703967276691339681&~.~&8399617365205998179&~("", -1, 1);
                            }
                            ~&214622607920&~ t_stdout = ~&6502785411&~.~&214637526116&~(cmdExecutor.executeCommand("/home/root/rime", ["candidate", ~&214629676161&~])).stdout;
                            ~&233724020023100&~.~&197092075&~(t_stdout);
                            ~&214622607920&~ t_output = ~&6502785411&~.~&214637526116&~(t_stdout);
                            ~&5972376&~(t_output.candidates.~&7082886407723&~ === 0) {
                                myValues.last_input_length = 0;
                            } ~&6503784146&~ {
                                myValues.last_input_length = t_output.preedit.~&7082886407723&~;
                            }
                            ~&1703967276691339681&~.~&8399617365205998179&~(t_output.preedit, 0, 0);
                            myValues.candidates = t_output.candidates;
                        }

                        ~&6503165774&~ {
                            ~&5972374&~: ~&7713604650796285&~
                            ~&214622605608&~: ~&"214646069354&~
                            ~&233721384511543&~.~&7712879746914881&~: ~&7083038346995&~
                            ~&6504315758&~: myValues.candidates[~&214629676161&~]
                            ~&214624865996&~: ~&6503165774&~.~&8397943310926068554&~
                            ~&6503823200&~.pointSize: 36

                            ~&453638707091284645&~ {
                                ~&5972374&~: ~&502649234619747013&~
                                ~&6503823200&~: ~&7713604650796285&~.~&6503823200&~  
                                ~&6504315758&~: myValues.candidates[~&214629676161&~]
                                ~&214624865996&~: ~&6503165774&~.~&8397943310926068554&~
                            }
                        }
                        ~&254494525842443467&~ {
                            ~&233721384511543&~.~&6503816592&~: ~&7083038346995&~
                            ~&254542236275632405&~: {
                                candidateSelect.insertstuff();
                            }
                        }
                    }
                }
            }
        }
    }
}
END TRAVERSE
TRAVERSE [[6502786168]]#[[6504254477]] > [[6502786168]]#[[12597697629085243357]] > [[6502786168]]#[[7066546362478499224]] > [[428051690305612204]][.[[7083194890448]]=[[1703967276691339681]]]
REPLACE [[16346390655820388197]] WITH {
	function ~&16346390655820388197&~(~&197090674&~) {
        ~&233724020023100&~.~&197092075&~(~&197090674&~);
        ~&233724020023100&~.~&197092075&~(~&197090674&~.~&6504337259&~); /* 1 is space, 0 is character, 5 is enter, 2 is backspace*/
        ~&5972376&~ (~&197090674&~.~&6504337259&~ === ~&10439014217414240874&~.~&214603375751&~ && ~&1703967276691339681&~.~&11444020482716919426&~) {
            ~&1703967276691339681&~.~&11444020482716919426&~ = ~&214625660372&~;
            ~&7083121450889&~;
        } ~&6503784146&~ ~&5972376&~ (~&197090674&~.~&6504337259&~ === ~&10439014217414240874&~.Language) {
            ~&5972376&~ (~&17315034820752293025&~.~&233748328658231&~) {
                ~&17315034820752293025&~.~&233748328658231&~ = ~&214625660372&~;
            } ~&6503784146&~ {
                ~&17315034820752293025&~.~&10742505288594076522&~ = ~&17315034820752293025&~.~&214634455770&~.~&233731717342038&~(~&1703967276691339681&~.~&7713258132170285&~);
                ~&17315034820752293025&~.~&233748328658231&~ = ~&6504329801&~;
            }
        } ~&6503784146&~ ~&5972376&~ (~&197090674&~.~&6504337259&~ === ~&10439014217414240874&~.Backspace) {
            ~&7738315215565644414&~.~&214641748151&~();
        }
        ~&214622607920&~ symbols = ~&1703967276691339681&~.~&10889605785547668464&~ ? ~&197090674&~.shiftedSymbols : ~&197090674&~.symbols;
        ~&7713221082613510&~.~&6503992357&~ = symbols.~&214641468857&~(1); /* skip first*/
        ~&7713221082613510&~.~&8400109567678042814&~ = ~&197090674&~.~&6504243191&~;
        ~&5972376&~ (symbols.~&7082886407723&~ > 1 || ~&197090674&~.~&6504337259&~ === ~&10439014217414240874&~.~&214603375751&~) {
            ~&4449098553666569383&~.~&8399947292675527336&~ = ~&197090674&~;
            ~&4449098553666569383&~.~&233743006639214&~();
        }
        ~&7713221082613510&~.~&233748328658231&~ = ~&214625660372&~;
	}
}
REPLACE [[4475313573200329364]] WITH {
    function ~&4475313573200329364&~(~&197090674&~) {
        ~&4449098553666569383&~.~&6504295855&~();
        ~&5972376&~ (~&197090674&~.~&6504337259&~ !== ~&10439014217414240874&~.~&214603375751&~ && !~&7713221082613510&~.~&233748328658231&~ && !~&1703967276691339681&~.~&11444020482716919426&~ && !~&1703967276691339681&~.symbolsSelected) {
            ~&1703967276691339681&~.~&10889605785547668464&~ = ~&214625660372&~;
        }
        ~&5972376&~ (~&197090674&~.~&6504337259&~ === ~&10439014217414240874&~.Backspace) {
            ~&7738315215565644414&~.~&6504295855&~();
        }
        ~&5972376&~(~&197090674&~.~&6504337259&~ == 0) {
            ~&233724020023100&~.~&197092075&~(~&197090674&~.symbols[0]);
            ~&197085552&~(~&197091758&~ ~&180978&~ = 0;~&180978&~<myValues.last_input_length + 1;~&180978&~++) {
                ~&1703967276691339681&~.~&8399617365205998179&~("", -1, 1);
            }
            ~&214622607920&~ stdout = ~&6502785411&~.~&214637526116&~(cmdExecutor.executeCommand("/home/root/rime", [~&"197090674&~, ~&197090674&~.symbols[0]])).stdout;
            ~&214622607920&~ output = ~&6502785411&~.~&214637526116&~(stdout);
            myValues.candidates = output.candidates;
            ~&5972376&~(output.candidates.~&7082886407723&~ === 0) {
                myValues.last_input_length = 0;
            } ~&6503784146&~ {
                myValues.last_input_length = output.preedit.~&7082886407723&~;
            }
            ~&1703967276691339681&~.~&8399617365205998179&~(output.preedit, 0, 0);
        }
        ~&5972376&~ (~&197090674&~.~&6504337259&~ === 1) {
            ~&197085552&~(~&197091758&~ ~&180978&~ = 0;~&180978&~<myValues.last_input_length + 1;~&180978&~++) {
                ~&1703967276691339681&~.~&8399617365205998179&~("", -1, 1);
            }
            ~&5972376&~(myValues.last_input_length === -1) {
                ~&7083121450889&~;
            }
            ~&214622607920&~ stdout = ~&6502785411&~.~&214637526116&~(cmdExecutor.executeCommand("/home/root/rime", [~&"197090674&~, ~&"180905&~])).stdout;
            ~&214622607920&~ output = ~&6502785411&~.~&214637526116&~(stdout);
            myValues.candidates = output.candidates;
            ~&5972376&~(output.candidates.~&7082886407723&~ === 0) {
                myValues.last_input_length = -1;
            } ~&6503784146&~ {
                myValues.last_input_length = output.preedit.~&7082886407723&~;
            }
            ~&1703967276691339681&~.~&8399617365205998179&~(output.preedit, 0, 0);
        }
        ~&5972376&~ (~&197090674&~.~&6504337259&~ === 2) {
            ~&214622607920&~ stdout = ~&6502785411&~.~&214637526116&~(cmdExecutor.executeCommand("/home/root/rime", [~&"254523440223991622&~])).stdout;
            ~&214622607920&~ output = ~&6502785411&~.~&214637526116&~(stdout);
            myValues.candidates = output.candidates;
            ~&197085552&~(~&197091758&~ ~&180978&~ = 0;~&180978&~<myValues.last_input_length-1;~&180978&~++) {
                ~&1703967276691339681&~.~&8399617365205998179&~("", -1, 1);
            }
            ~&5972376&~(output.candidates.~&7082886407723&~ === 0) {
                myValues.last_input_length = 1;
            } ~&6503784146&~ {
                myValues.last_input_length = output.preedit.~&7082886407723&~;
            }
            ~&1703967276691339681&~.~&8399617365205998179&~(output.preedit, 0, 0);
        }
    }
}
END TRAVERSE
TRAVERSE [[6502786168]]#[[6504254477]] > [[6502786168]]#[[12597697629085243357]] > [[6502786168]]#[[7066546362478499224]] > [[214604601930]][.[[5972374]]=[[7738315215565644414]]]
REPLACE [[495358363329399331]] WITH {
    ~&495358363329399331&~: {
        /* Gradually speed up repeat rate while holding down*/
        ~&5972376&~ (~&7713147298280334&~ > ~&9741980301803963882&~) {
            ~&7713147298280334&~ = ~&6502909715&~.~&197092719&~(~&9741980301803963882&~, ~&7713147298280334&~ - ~&254526423772241792&~);
        }
        ~&1703967276691339681&~.~&10321198830654543930&~();
    }
}
END TRAVERSE
END AFFECT
